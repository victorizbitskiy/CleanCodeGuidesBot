#### Не создавайте подклассы чтобы замокать методы

> [Чистый ABAP] > [Содержание] > [Тестирование] > [Инъекция] > [Эта секция]

Не создавайте подклассы и не переопределяйте методы, чтобы моделировать их в модульных тестах. 
Это решение хоть и работает, но оно хрупкое, потому что тесты часто перестают работать после рефакторинга кода. 
Кроме того, оно позволяет реальным потребителям наследоваться от вашего класса, 
что [может привести к неприятным сюрпризам, если вы явно не спроектируете его для наследования](#final-если-не-предназначен-для-наследования).

```ABAP
" anti-pattern
CLASS unit_tests DEFINITION INHERITING FROM /dirty/real_class FOR TESTING [...].
  PROTECTED SECTION.
    METHODS needs_to_be_mocked REDEFINITION.
```

Чтобы тестировать устаревший код, все же лучше [использовать тестовые швы](#используйте-тестовые-швы-как-временное-решение). 
Они такие же хрупкие, но все же самые чистые решения, поскольку они не изменяют продуктивное поведение класса, 
в отличие от включения наследования путем удаления флага `FINAL` или изменения области действия метода с `PRIVATE` на `PROTECTED`.

При написании нового кода учитывайте эту проблему тестируемости непосредственно при разработке класса 
и найдите другой, лучший способ. 
Общепринятые лучшие практики включают [использование инструментов тестирования](#используйте-инструменты-тестирования)
и выделение проблемного метода в отдельный класс с собственным интерфейсом.

> Более конкретный вариант
> [Не изменяйте продуктивный код, чтобы сделать код пригодным для тестирования](#не-изменяйте-продуктивный-код-чтобы-сделать-код-пригодным-для-тестирования).
